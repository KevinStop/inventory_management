import{a as ee,b as te}from"./chunk-2DAWELSL.js";import"./chunk-O7HXUX3S.js";import{a as K}from"./chunk-DK2NHJD3.js";import{a as X,b as Y}from"./chunk-A5RISXGS.js";import{a as W}from"./chunk-MHTYV42J.js";import"./chunk-NKQOLO4R.js";import"./chunk-OMJYBY2Z.js";import{T as D,X as w}from"./chunk-NVUV4KG5.js";import"./chunk-4YRY4IP2.js";import{a as J}from"./chunk-X5OPW46L.js";import{b as A,e as R,h as $,j as Z,p as z,q as P,u as G}from"./chunk-SGIGSFT7.js";import{d as U}from"./chunk-LQDACG22.js";import{i as N,j as q,r as B}from"./chunk-GMFH3NDN.js";import{Ab as T,Gb as l,Hb as S,Ib as V,Ka as _,Kb as O,Lb as Q,Mb as j,Na as F,Nb as H,Ob as L,Pa as a,Qa as f,_ as E,bb as y,db as c,fb as I,ha as g,ia as u,ja as x,ka as k,mb as n,nb as o,ob as h,sb as b,vb as p,wb as m,zb as C}from"./chunk-ETUY2JGY.js";function ie(s,t){if(s&1){let e=b();n(0,"div",22)(1,"input",23),p("change",function(r){let d=g(e).$implicit,v=m(2);return u(v.handleCategoryChange(r,d.id))}),o(),n(2,"label",24),l(3),o()()}if(s&2){let e=t.$implicit,i=m(2);a(),c("id","category-"+e.id)("value",e.id)("checked",i.selectedCategories.includes(e.id)),a(),c("for","category-"+e.id),a(),V(" ",e.name," ")}}function re(s,t){if(s&1){let e=b();n(0,"div",14)(1,"div",15)(2,"h5",16),l(3,"Categor\xEDas"),o(),n(4,"div",17),y(5,ie,4,5,"div",18),o()(),n(6,"div",19)(7,"button",20),p("click",function(){g(e);let r=m();return u(r.applyFilters())}),l(8," Aplicar Filtros "),o(),n(9,"button",21),p("click",function(){g(e);let r=m();return u(r.resetFilters())}),l(10," Reiniciar "),o()()()}if(s&2){let e=m();a(5),c("ngForOf",e.categories)}}function ne(s,t){if(s&1){let e=b();n(0,"div",25)(1,"div",26),h(2,"img",27)(3,"img",28),o(),n(4,"div",29)(5,"p",30),l(6),o(),n(7,"ul",31)(8,"li",32),x(),n(9,"svg",33),h(10,"path",34),o(),k(),n(11,"p",35),l(12),o()()(),n(13,"p",36),l(14),o(),n(15,"div",37)(16,"div",38)(17,"input",39),j("ngModelChange",function(r){let d=g(e).$implicit,v=m();return Q(v.selectedQuantities[d.id],r)||(v.selectedQuantities[d.id]=r),u(r)}),p("ngModelChange",function(r){let d=g(e).$implicit,v=m();return u(v.onQuantityChange(d.id,r))}),o()(),n(18,"button",40),p("click",function(){let r=g(e).$implicit,d=m();return u(d.addToSelectedList(r))}),x(),n(19,"svg",41),h(20,"path",42),o(),l(21," Agregar "),o()()()()}if(s&2){let e=t.$implicit,i=m();a(2),C("alt",e.name),c("src",i.apiUrls+e.imageUrl,_),a(),C("alt",e.name),c("src",i.apiUrls+e.imageUrl,_),a(3),S(e.name),a(6),S(e.category==null?null:e.category.name),a(2),V(" Disponible: ",e.availableQuantity," "),a(3),T("id","quantity-",e.id,""),C("max",e.availableQuantity),O("ngModel",i.selectedQuantities[e.id])}}function oe(s,t){s&1&&(n(0,"div",43),l(1," No hay componentes disponibles para mostrar. "),o())}var M=class s{constructor(t,e,i,r,d){this.componentService=t;this.requestService=e;this.sweetalertService=i;this.categoryService=r;this.messageService=d}apiUrls=U.apiUrl;components=[];selectedQuantities={};selectedCategories=[];filteredComponents=[];categories=[];isFilterMenuOpen=!1;ngOnInit(){J(),this.getComponents(),this.loadSelectedComponents(),this.getCategories()}getCategories(){this.categoryService.getCategories().subscribe(t=>{this.categories=t},t=>{console.error("Error al obtener las categor\xEDas:",t),this.sweetalertService.error("Error al obtener las categor\xEDas")})}getComponents(){this.componentService.getComponents(!0).subscribe(t=>{this.components=t.components.filter(e=>e.isActive&&e.availableQuantity>0),this.filteredComponents=[...this.components]},t=>{console.error("Error al obtener los componentes:",t),this.sweetalertService.error("Error al obtener los componentes.")})}onQuantityChange(t,e){let i=this.components.find(r=>r.id===t);if(i){let r=i.availableQuantity;e>r?(this.selectedQuantities[t]=r,this.sweetalertService.error(`La cantidad no puede exceder el m\xE1ximo disponible (${r}).`),this.messageService.add({severity:"warn",summary:"Cantidad ajustada",detail:`La cantidad se ha ajustado al m\xE1ximo disponible: ${r}`,life:3e3})):e<=0?(this.selectedQuantities[t]=1,this.messageService.add({severity:"warn",summary:"Cantidad inv\xE1lida",detail:"La cantidad debe ser mayor a 0",life:3e3})):this.selectedQuantities[t]=e}}onCategoryChange(t,e){e?this.selectedCategories.includes(t)||this.selectedCategories.push(t):this.selectedCategories=this.selectedCategories.filter(i=>i!==t),this.applyFilters()}applyFilters(){this.selectedCategories.length>0?this.filteredComponents=this.components.filter(t=>this.selectedCategories.includes(t.categoryId)):this.filteredComponents=[...this.components],this.isFilterMenuOpen=!1}resetFilters(){this.selectedCategories=[],this.filteredComponents=[...this.components],document.querySelectorAll('input[type="checkbox"]').forEach(e=>{e.checked=!1}),this.isFilterMenuOpen=!1}loadSelectedComponents(){let t=JSON.parse(localStorage.getItem("selectedComponents")||"[]");this.selectedQuantities=t.reduce((e,i)=>(e[i.id]=i.quantity,e),{})}addToSelectedList(t){let e=this.selectedQuantities[t.id];if(e&&e>0&&Number.isInteger(e)){this.requestService.addSelectedComponentToStorage(t,e),this.messageService.add({severity:"info",summary:"Componente agregado",detail:"Componente agregado exitosamente. ",life:2e3});return}else this.sweetalertService.error("Debe seleccionar una cantidad v\xE1lida para agregar el componente."),this.loadSelectedComponents()}handleCategoryChange(t,e){let i=t.target;this.onCategoryChange(e,i.checked)}toggleFilterMenu(){this.isFilterMenuOpen=!this.isFilterMenuOpen}onClickOutside(t){let e=document.querySelector(".relative.inline-block");e&&!e.contains(t.target)&&(this.isFilterMenuOpen=!1)}static \u0275fac=function(e){return new(e||s)(f(X),f(K),f(W),f(Y),f(w))};static \u0275cmp=E({type:s,selectors:[["app-view-components"]],hostBindings:function(e,i){e&1&&p("click",function(d){return i.onClickOutside(d)},!1,F)},standalone:!0,features:[H([w,D]),L],decls:18,vars:5,consts:[[1,"bg-white","py-5","antialiased","dark:bg-gray-900","rounded-lg"],[1,"mx-auto","max-w-screen-xl","px-4","2xl:px-0"],[1,"mb-4","items-end","justify-between","space-y-4","sm:flex","sm:space-y-0","md:mb-8"],[1,"mt-3","text-xl","font-semibold","text-gray-900","dark:text-white","sm:text-2xl"],[1,"relative","inline-block"],["type","button",1,"flex","w-full","items-center","justify-center","rounded-lg","border","border-gray-200","bg-white","px-3","py-2","text-sm","font-medium","text-gray-900","hover:bg-gray-100","hover:text-primary-700","focus:z-10","focus:outline-none","focus:ring-4","focus:ring-gray-100","dark:border-gray-600","dark:bg-gray-800","dark:text-gray-400","dark:hover:bg-gray-700","dark:hover:text-white","dark:focus:ring-gray-700","sm:w-auto",3,"click"],["aria-hidden","true","xmlns","http://www.w3.org/2000/svg","width","24","height","24","fill","none","viewBox","0 0 24 24",1,"-ms-0.5","me-2","h-4","w-4"],["stroke","currentColor","stroke-linecap","round","stroke-width","2","d","M18.796 4H5.204a1 1 0 0 0-.753 1.659l5.302 6.058a1 1 0 0 1 .247.659v4.874a.5.5 0 0 0 .2.4l3 2.25a.5.5 0 0 0 .8-.4v-7.124a1 1 0 0 1 .247-.659l5.302-6.059c.566-.646.106-1.658-.753-1.658Z"],["aria-hidden","true","xmlns","http://www.w3.org/2000/svg","width","24","height","24","fill","none","viewBox","0 0 24 24",1,"-me-0.5","ms-2","h-4","w-4"],["stroke","currentColor","stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","m19 9-7 7-7-7"],["class","absolute right-0 mt-2 w-64 rounded-lg bg-white p-4 shadow-lg dark:bg-gray-800 dark:border dark:border-gray-700",4,"ngIf"],[1,"mb-4","grid","gap-4","sm:grid-cols-2","md:mb-8","lg:grid-cols-3","xl:grid-cols-4"],["class","rounded-lg border border-gray-200 bg-white p-6 shadow-sm dark:border-gray-700 dark:bg-gray-800",4,"ngFor","ngForOf"],["class","text-center text-lg font-semibold text-gray-500 dark:text-gray-300",4,"ngIf"],[1,"absolute","right-0","mt-2","w-64","rounded-lg","bg-white","p-4","shadow-lg","dark:bg-gray-800","dark:border","dark:border-gray-700"],[1,"space-y-4"],[1,"text-lg","font-medium","text-black","dark:text-white"],[1,"space-y-2"],["class","flex items-center",4,"ngFor","ngForOf"],[1,"mt-4","flex","flex-col","space-y-2"],["type","button",1,"rounded-lg","bg-primary-700","px-4","py-2","text-center","text-sm","font-medium","text-white","hover:bg-primary-800","focus:outline-none","focus:ring-4","focus:ring-primary-300","dark:bg-primary-700","dark:hover:bg-primary-800","dark:focus:ring-primary-800",3,"click"],["type","button",1,"rounded-lg","border","border-gray-200","bg-white","px-4","py-2","text-sm","font-medium","text-gray-900","hover:bg-gray-100","hover:text-primary-700","focus:z-10","focus:outline-none","focus:ring-4","focus:ring-gray-200","dark:border-gray-600","dark:bg-gray-800","dark:text-gray-400","dark:hover:bg-gray-700","dark:hover:text-white","dark:focus:ring-gray-700",3,"click"],[1,"flex","items-center"],["type","checkbox",1,"h-4","w-4","rounded","border-gray-300","bg-gray-100","text-primary-600","focus:ring-2","focus:ring-primary-500","dark:border-gray-600","dark:bg-gray-700","dark:ring-offset-gray-800","dark:focus:ring-primary-600",3,"change","id","value","checked"],[1,"ml-2","text-sm","font-medium","text-gray-900","dark:text-gray-300",3,"for"],[1,"rounded-lg","border","border-gray-200","bg-white","p-6","shadow-sm","dark:border-gray-700","dark:bg-gray-800"],[1,"h-36","w-full"],[1,"mx-auto","h-full","dark:hidden",3,"src","alt"],[1,"mx-auto","hidden","h-full","dark:block",3,"src","alt"],[1,"pt-6"],[1,"text-lg","font-semibold","leading-tight","text-gray-900","dark:text-white"],[1,"mt-2","flex","items-center","gap-4"],[1,"flex","items-center","gap-2"],["aria-hidden","true","xmlns","http://www.w3.org/2000/svg","fill","none","viewBox","0 0 24 24",1,"h-4","w-4","text-gray-500","dark:text-gray-400"],["stroke","currentColor","stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M13 7h6l2 4m-8-4v8m0-8V6a1 1 0 0 0-1-1H4a1 1 0 0 0-1 1v9h2m8 0H9m4 0h2m4 0h2v-4m0 0h-5m3.5 5.5a2.5 2.5 0 1 1-5 0 2.5 2.5 0 0 1 5 0Zm-10 0a2.5 2.5 0 1 1-5 0 2.5 2.5 0 0 1 5 0Z"],[1,"text-sm","font-medium","text-gray-500","dark:text-gray-400"],[1,"mt-2","text-lg","font-semibold","leading-tight","text-gray-900","dark:text-white"],[1,"mt-2","flex","items-center","justify-between","gap-4"],[1,"mt-2"],["type","number","min","1",1,"mt-1","block","w-full","p-2","border","border-gray-300","rounded-md","text-black","dark:bg-gray-800","dark:text-white","dark:border-gray-700","text-center",3,"ngModelChange","id","ngModel","max"],["type","button",1,"inline-flex","items-center","rounded-lg","bg-primary-700","px-5","py-2.5","text-sm","font-medium","text-white","hover:bg-primary-800","focus:outline-none","focus:ring-4","focus:ring-primary-300","dark:bg-primary-600","dark:hover:bg-primary-700","dark:focus:ring-primary-800",3,"click"],["aria-hidden","true","xmlns","http://www.w3.org/2000/svg","width","24","height","24","fill","none","viewBox","0 0 24 24",1,"-ms-2","me-2","h-5","w-5"],["stroke","currentColor","stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M4 4h1.5L8 16m0 0h8m-8 0a2 2 0 1 0 0 4 2 2 0 0 0 0-4Zm8 0a2 2 0 1 0 0 4 2 2 0 0 0 0-4Zm.75-3H7.5M11 7H6.312M17 4v6m-3-3h6"],[1,"text-center","text-lg","font-semibold","text-gray-500","dark:text-gray-300"]],template:function(e,i){e&1&&(n(0,"section",0)(1,"div",1),h(2,"p-toast"),n(3,"div",2)(4,"div")(5,"h2",3),l(6,"Componentes Electr\xF3nicos"),o()(),n(7,"div",4)(8,"button",5),p("click",function(){return i.toggleFilterMenu()}),x(),n(9,"svg",6),h(10,"path",7),o(),l(11," Filtros "),n(12,"svg",8),h(13,"path",9),o()(),y(14,re,11,1,"div",10),o()(),k(),n(15,"div",11),y(16,ne,22,11,"div",12),o(),y(17,oe,2,0,"div",13),o()()),e&2&&(a(12),I("rotate-180",i.isFilterMenuOpen),a(2),c("ngIf",i.isFilterMenuOpen),a(2),c("ngForOf",i.filteredComponents),a(),c("ngIf",!i.components.length))},dependencies:[B,N,q,G,A,Z,R,P,z,$,te,ee],encapsulation:2})};export{M as default};
