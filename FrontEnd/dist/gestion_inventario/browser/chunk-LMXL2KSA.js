import{a as J}from"./chunk-DSP6QF7L.js";import{a as $}from"./chunk-MHTYV42J.js";import"./chunk-NKQOLO4R.js";import{a as H}from"./chunk-X5OPW46L.js";import{b as M,c as _,e as G,f as O,i as B,k as j,l as R,t as z,u as L,v as q}from"./chunk-SGIGSFT7.js";import"./chunk-LQDACG22.js";import{i as A,j as T,p as V,r as N}from"./chunk-GMFH3NDN.js";import{$b as D,Fb as I,Gb as r,Hb as f,Ib as y,Jb as F,Ob as C,Pa as n,Qa as w,Yb as h,_ as k,_b as b,bb as p,db as s,ha as u,ia as g,mb as i,nb as t,ob as E,sb as x,vb as v,wb as m}from"./chunk-ETUY2JGY.js";function K(o,a){if(o&1){let e=x();i(0,"div",9)(1,"p",10),r(2," Per\xEDodo Activo: "),i(3,"strong"),r(4),t(),r(5),h(6,"date"),h(7,"date"),t(),i(8,"div")(9,"button",11),v("click",function(){u(e);let d=m();return g(d.isEdit?d.openCreateForm():d.openEditForm())}),r(10),t(),i(11,"button",12),v("click",function(){u(e);let d=m();return g(d.toggleInactiveTable())}),r(12),t()()()}if(o&2){let e=m();n(4),f(e.activePeriod.name),n(),F(" (",b(6,5,e.activePeriod.startDate,"dd/MM/yyyy")," - ",b(7,8,e.activePeriod.endDate,"dd/MM/yyyy"),") "),n(5),y(" ",e.isEdit?"Crear Per\xEDodo":"Editar Per\xEDodo"," "),n(2),y(" ",e.showInactiveTable?"Ocultar Inactivos":"Ver Inactivos"," ")}}function Q(o,a){if(o&1){let e=x();i(0,"button",13),v("click",function(){u(e);let d=m();return g(d.openCreateForm())}),r(1," Asignar Per\xEDodo Acad\xE9mico "),t()}}function U(o,a){o&1&&(i(0,"p",23),r(1," El nombre es obligatorio y debe tener al menos 3 caracteres. "),t())}function W(o,a){o&1&&(i(0,"p",23),r(1," La fecha de inicio es obligatoria. "),t())}function X(o,a){o&1&&(i(0,"p",23),r(1," La fecha de fin es obligatoria. "),t())}function Y(o,a){o&1&&(i(0,"p",23),r(1," La fecha de fin debe ser posterior a la fecha de inicio. "),t())}function Z(o,a){if(o&1){let e=x();i(0,"div",14)(1,"h3",15),r(2),t(),i(3,"form",16),v("ngSubmit",function(){u(e);let d=m();return g(d.savePeriod())}),i(4,"div")(5,"label",17),r(6,"Nombre"),t(),E(7,"input",18),p(8,U,2,0,"p",19),t(),i(9,"div")(10,"label",17),r(11,"Fecha de Inicio"),t(),E(12,"input",20),p(13,W,2,0,"p",19),t(),i(14,"div")(15,"label",17),r(16,"Fecha de Fin"),t(),E(17,"input",21),p(18,X,2,0,"p",19)(19,Y,2,0,"p",19),t(),i(20,"button",22),r(21),t()()()}if(o&2){let e,c,d,P,l=m();n(2),y(" ",l.isEdit?"Editar Per\xEDodo Acad\xE9mico":"Nuevo Per\xEDodo Acad\xE9mico"," "),n(),s("formGroup",l.periodForm),n(5),s("ngIf",((e=l.periodForm.get("name"))==null?null:e.invalid)&&((e=l.periodForm.get("name"))==null?null:e.touched)),n(5),s("ngIf",((c=l.periodForm.get("startDate"))==null?null:c.invalid)&&((c=l.periodForm.get("startDate"))==null?null:c.touched)),n(5),s("ngIf",((d=l.periodForm.get("endDate"))==null?null:d.invalid)&&((d=l.periodForm.get("endDate"))==null?null:d.touched)),n(),s("ngIf",(l.periodForm.errors==null?null:l.periodForm.errors.dateRangeInvalid)&&((P=l.periodForm.get("endDate"))==null?null:P.touched)),n(2),y(" ",l.isEdit?"Actualizar":"Guardar"," ")}}function ee(o,a){if(o&1){let e=x();i(0,"tr",29)(1,"td",30),r(2),t(),i(3,"td",30),r(4),h(5,"date"),t(),i(6,"td",30),r(7),h(8,"date"),t(),i(9,"td",30)(10,"button",31),v("click",function(){let d=u(e).$implicit,P=m(2);return g(P.activatePeriod(d.id))}),r(11," Activar "),t()()()}if(o&2){let e=a.$implicit;n(2),f(e.name),n(2),f(b(5,3,e.startDate,"yyyy-MM-dd")),n(3),f(b(8,6,e.endDate,"yyyy-MM-dd"))}}function te(o,a){if(o&1&&(i(0,"div",24)(1,"table",25)(2,"thead",26)(3,"tr")(4,"th",27),r(5,"Nombre"),t(),i(6,"th",27),r(7,"Fecha de Inicio"),t(),i(8,"th",27),r(9,"Fecha de Fin"),t(),i(10,"th",27),r(11,"Acciones"),t()()(),i(12,"tbody"),p(13,ee,12,9,"tr",28),t()()()),o&2){let e=m();n(13),s("ngForOf",e.inactivePeriods)}}var S=class o{constructor(a,e,c){this.academicPeriodsService=a;this.fb=e;this.sweetalertService=c;this.periodForm=this.fb.group({name:["",[_.required,_.minLength(3)]],startDate:["",[_.required]],endDate:["",[_.required]]},{validators:[this.dateRangeValidator]})}academicPeriods=[];activePeriod=null;inactivePeriods=[];isEdit=!1;showInactiveTable=!1;periodForm;ngOnInit(){H(),this.loadPeriods()}loadPeriods(){this.academicPeriodsService.getAcademicPeriods().subscribe({next:a=>{this.academicPeriods=a.academicPeriods,this.activePeriod=this.academicPeriods.find(e=>e.isActive)||null,this.inactivePeriods=this.academicPeriods.filter(e=>!e.isActive)},error:a=>{console.error("Error al cargar los per\xEDodos:",a),this.sweetalertService.error("Error al cargar los per\xEDodos acad\xE9micos.")}})}openCreateForm(){this.isEdit=!1,this.showInactiveTable=!1,this.periodForm.reset()}openEditForm(){this.isEdit=!0,this.showInactiveTable=!1,this.activePeriod&&this.periodForm.patchValue({name:this.activePeriod.name,startDate:new Date(this.activePeriod.startDate).toISOString().split("T")[0],endDate:new Date(this.activePeriod.endDate).toISOString().split("T")[0]})}savePeriod(){if(this.periodForm.invalid){this.sweetalertService.error("Por favor, completa todos los campos correctamente.");return}let a=this.periodForm.value;this.isEdit?this.academicPeriodsService.updateAcademicPeriod(this.activePeriod.id,a).subscribe({next:()=>{this.loadPeriods(),this.sweetalertService.success("Per\xEDodo actualizado con \xE9xito.")},error:e=>{console.error("Error al actualizar el per\xEDodo:",e),this.sweetalertService.error("Error al actualizar el per\xEDodo acad\xE9mico.")}}):this.academicPeriodsService.createAcademicPeriod(a).subscribe({next:e=>{this.academicPeriodsService.activateAcademicPeriod(e.id).subscribe({next:()=>{this.loadPeriods(),this.sweetalertService.success("Nuevo per\xEDodo creado y activado con \xE9xito.")},error:c=>{console.error("Error al activar el per\xEDodo:",c),this.sweetalertService.error("Error al activar el nuevo per\xEDodo acad\xE9mico.")}})},error:e=>{console.error("Error al crear el per\xEDodo:",e),this.sweetalertService.error("Error al crear el per\xEDodo acad\xE9mico.")}})}toggleInactiveTable(){this.showInactiveTable=!this.showInactiveTable,this.showInactiveTable&&(this.isEdit=!1,this.periodForm.reset())}activatePeriod(a){this.academicPeriodsService.activateAcademicPeriod(String(a)).subscribe({next:()=>{this.loadPeriods(),this.sweetalertService.success("Per\xEDodo activado con \xE9xito.")},error:e=>{console.error("Error al activar el per\xEDodo:",e),this.sweetalertService.error("Error al activar el per\xEDodo acad\xE9mico.")}})}dateRangeValidator(a){let e=new Date(a.get("startDate")?.value);return new Date(a.get("endDate")?.value)>e?null:{dateRangeInvalid:!0}}static \u0275fac=function(e){return new(e||o)(w(J),w(z),w($))};static \u0275cmp=k({type:o,selectors:[["app-academic-periods"]],standalone:!0,features:[C],decls:11,vars:4,consts:[["noActivePeriod",""],[1,"bg-white","py-8","dark:bg-gray-900","rounded-lg"],[1,"mx-auto","max-w-screen-xl","px-4","2xl:px-0"],[1,"mx-auto","max-w-5xl"],[1,"text-xl","font-semibold","text-gray-900","dark:text-white","sm:text-2xl"],[1,"mt-6"],["class","flex items-center justify-between",4,"ngIf","ngIfElse"],["class","mt-8 bg-gray-100 dark:bg-gray-800 p-6 rounded-lg",4,"ngIf"],["class","mt-6 overflow-hidden rounded-lg border border-gray-200 dark:border-gray-700",4,"ngIf"],[1,"flex","items-center","justify-between"],[1,"text-lg","text-gray-700","dark:text-gray-200"],[1,"px-4","py-2","text-sm","bg-primary-600","text-white","rounded-lg","hover:bg-primary-700","focus:ring-4","focus:ring-primary-300",3,"click"],[1,"ml-2","px-4","py-2","text-sm","bg-gray-600","text-white","rounded-lg","hover:bg-gray-700","focus:ring-4","focus:ring-gray-300",3,"click"],[1,"mt-4","px-4","py-2","text-sm","bg-primary-600","text-white","rounded-lg","hover:bg-primary-700","focus:ring-4","focus:ring-primary-300",3,"click"],[1,"mt-8","bg-gray-100","dark:bg-gray-800","p-6","rounded-lg"],[1,"text-lg","font-semibold","text-gray-900","dark:text-white","text-center","mb-4"],[1,"space-y-4",3,"ngSubmit","formGroup"],[1,"block","mb-2","text-sm","font-medium","text-gray-900","dark:text-white"],["type","text","formControlName","name","placeholder","Ejemplo: 2024-1",1,"w-full","p-2","text-sm","border","border-gray-300","rounded-lg","bg-white","text-gray-900","placeholder-gray-400","focus:ring-primary-300","focus:border-primary-300","dark:bg-gray-700","dark:border-gray-600","dark:text-white","dark:placeholder-gray-400","dark:focus:ring-primary-500","dark:focus:border-primary-500"],["class","text-red-500 text-sm",4,"ngIf"],["type","date","formControlName","startDate",1,"w-full","p-2","text-sm","border","border-gray-300","rounded-lg","bg-white","text-gray-900","placeholder-gray-400","focus:ring-primary-300","focus:border-primary-300","[color-scheme:light]","dark:[color-scheme:dark]","dark:bg-gray-700","dark:border-gray-600","dark:text-white","dark:placeholder-gray-400","dark:focus:ring-primary-500","dark:focus:border-primary-500"],["type","date","formControlName","endDate",1,"w-full","p-2","text-sm","border","border-gray-300","rounded-lg","bg-white","text-gray-900","placeholder-gray-400","focus:ring-primary-300","focus:border-primary-300","[color-scheme:light]","dark:[color-scheme:dark]","dark:bg-gray-700","dark:border-gray-600","dark:text-white","dark:placeholder-gray-400","dark:focus:ring-primary-500","dark:focus:border-primary-500"],["type","submit",1,"px-5","py-2","bg-primary-600","text-white","rounded-lg","hover:bg-primary-700","focus:ring-4","focus:ring-primary-300","dark:focus:ring-primary-500"],[1,"text-red-500","text-sm"],[1,"mt-6","overflow-hidden","rounded-lg","border","border-gray-200","dark:border-gray-700"],[1,"min-w-full","text-left","text-sm","text-gray-500","dark:text-gray-400"],[1,"bg-gray-50","dark:bg-gray-700"],["scope","col",1,"px-6","py-3"],["class","bg-white dark:bg-gray-800",4,"ngFor","ngForOf"],[1,"bg-white","dark:bg-gray-800"],[1,"px-6","py-4"],[1,"px-3","py-2","text-sm","bg-primary-600","text-white","rounded-lg","hover:bg-primary-700","focus:ring-4","focus:ring-primary-300",3,"click"]],template:function(e,c){if(e&1&&(i(0,"section",1)(1,"div",2)(2,"div",3)(3,"h2",4),r(4," Gesti\xF3n de Per\xEDodos Acad\xE9micos "),t(),i(5,"div",5),p(6,K,13,11,"div",6)(7,Q,2,0,"ng-template",null,0,D),t(),p(9,Z,22,7,"div",7)(10,te,14,1,"div",8),t()()()),e&2){let d=I(8);n(6),s("ngIf",c.activePeriod)("ngIfElse",d),n(3),s("ngIf",!c.showInactiveTable),n(),s("ngIf",c.showInactiveTable)}},dependencies:[N,A,T,V,L,B,M,G,O,q,j,R],encapsulation:2})};export{S as default};
